<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ESP Beacon Spam</title>
    <style>
        :root {
            --bg: #000;
            --card: #161b22;
            --border: #30363d;
            --text: #c9d1d9;
            --dim: #8b949e;
            --accent: #58a6ff;
            --btn: linear-gradient(135deg, #238636, #2ea043)
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column
        }

        iframe {
            border: none;
            width: 100%;
            flex: 1;
            background: #fff
        }

        .foot-bar {
            background: var(--card);
            border-top: 1px solid var(--border);
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99
        }

        .btn {
            display: block;
            width: 100%;
            max-width: 400px;
            padding: 14px 20px;
            background: var(--btn);
            color: #fff;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: transform .2s, box-shadow .2s
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(35, 134, 54, .4)
        }

        .attr {
            margin-top: 8px;
            font-size: 10px;
            color: var(--dim)
        }

        .attr a {
            color: var(--dim);
            text-decoration: none
        }
    </style>
</head>

<body>
    <iframe src="/content" title="Portal Content"></iframe>

    <div class="foot-bar" id="fb">
        <a href="#" class="btn" id="btn"
            onclick="connect('https://github.com/John-Varghese-EH/ESP8266-BeaconSpamAds')">Connect</a>
        <div class="attr">Made with ❤️ by <a href="https://github.com/John-Varghese-EH">John-Varghese-EH</a></div>
    </div>

    <script>
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).catch(function (err) { fallbackCopyTextToClipboard(text); });
            } else { fallbackCopyTextToClipboard(text); }
        }
        function fallbackCopyTextToClipboard(text) {
            var textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0"; textArea.style.left = "0"; textArea.style.position = "fixed";
            document.body.appendChild(textArea);
            textArea.focus(); textArea.select();
            try { document.execCommand('copy'); } catch (err) { }
            document.body.removeChild(textArea);
        }
        function connect(url) {
            copyToClipboard(url);
            fetch('/disconnect').catch(e => { });
            document.getElementById('btn').innerText = 'Opening...';
            setTimeout(function () { window.location.href = url; }, 500);
        }

        // Fetch dynamic config
        fetch('/api/public_data').then(r => r.json()).then(d => {
            // Button Text
            if (d.buttonText && d.buttonText !== "0") {
                document.getElementById('btn').textContent = d.buttonText;
            } else {
                // If buttonText is 0 or empty, we generally hide the footer, 
                // but this static file just mimics the layout.
            }

            // Redirect URL
            if (d.redirectUrl) {
                document.getElementById('btn').onclick = function () { connect(d.redirectUrl); };
            }
        }).catch(() => { });
    </script>
</body>

</html>